### Changelog
Все значимые изменения и история версий записаны в этом файле.
#### [1.2.0] - 2026-02-01
- Добавлен Post Process модуль для отбора кандидатов уже после завершения оптимизации, он включает в себя Deflated Sharpe Ratio (DSR), Forward Test (FT) и Stress Test (ST) - можно включать все вместе и по отдельности
- Добавлены Winrate % (таргет и ограничение) и Consecutive Losses (только ограничение) - они теперь выводятся в таблицу результатов
- Добавлена функция Manual Test - тестирование на отдельно заданном периоде выбранного сета параметров (запускается после завершения оптимизации)
- Добавлена функция OOS Test - автоматизированный аналог Manual Test - теперь можно заранее решить будет ли выполняться тестирование на отдельном периоде после оптимизации, при включении OOS Test - WFA недоступен, и наоборот
- Сделан рефактор результатов WFA - теперь такая же логика как у результатов Optuna (графики equity, табы, таблицы с сетами параметров итд)
#### [1.1.0] - 2026-01-11
- Сделан рефактор WFA модуля - теперь он работает так, как должен (IS окно - оптимизация, OOS окно - симуляция торговли топ-1 сета параметров, после завершения работы выводится склеенная по всем OOS окнам equity кривая)
- Добавлена новая страница Results - она полностью заменяет CSV вывод + дополнительно отображает equity кривую + из нее можно делать Download Trades для выбранного сета параметров
- Интегрирована SQLite база данных - теперь все результаты исследований Optuna и WFA хранятся там
- Сделан большой апдейт Optuna модуля - добавлена возможность выбора нескольких целей оптимизации, добавлены NSGA II и III сэмплеры, добавлены ограничения для оптимизации
- Добавлена отключаемая возможность sanitize (работает только для Sharpe, Sortino, SQN, PF если они являются целью оптимизации), если PF = inf, это не сантайзится, такой трайл будет failed - это нужно для понимания сэмплера Optuna где живут "плохие" результаты (по дефолту выполняется только когда трейдов = 0, то есть чтобы Optuna не закидывала параметры из этой проблемной области)
- Сделан рефактор Composite Score - теперь она детерминированная, ей не нужны другие трайлы для оценки (предыдущая версия осталась, можно переключать если надо), это нужно для корректной многопоточности
#### [1.0.9] - 2025-12-20
- Добавлена многопоточность в Optuna
- Исправлено - часть параметров не выводилась (N/A) в WFA CSV (Trail RR, ATR Period итд)
- Убран dynamic warmup, теперь количество warmup bars задается только напрямую в UI
- Исправлено расхождение первого трейда с TradingView - в WFA модуль добавлен helper, который напрямую указывает начинать торговать с 00:00 требуемого дня
- Исправлено - wf_config NameError bug in export_wfa_trades_history
- Исправлено - presets directory casing in server.py
- Исправлено - silent strategy resolution failure during CSV import
- Исправлено - invalid numeric CSV values silently become 0 / 0.0
- Исправлено - create param_id() swallows all exceptions
#### [1.0.0] - 2025-12-16
- Проведена полная миграция на новую архитектуру - ядро + модули + добавление стратегий + разбивка монолитного html. Это была очень сложная задача, на все потрачено почти месяц
- Параллельно сделано множество фиксов - в целом все работает, в проекте сейчас две стратегии, обе оптимизируются, все функции на них работают
- Теперь проект называется Merlin - потому что он крутой волшебник
#### [0.3.8] - 2025-11-27
- Проведена частичная миграция на новую архитектуру - одно ядро + разные стратегии, задача оказалась сложнее, чем казалось, поэтому дальше будет еще большой этап миграции. Все промпты + аудиты и доки по миграции лежат в ./info/
- Сделаны несколько фиксов после завершения миграции - в целом проект более-менее работает, все функции сохранились
#### [0.2.11] - 2025-11-20
- Добавлен Walk-Forward Analysis Stage 1 MVP
- Обновлены дефолты для Optimizer секции (включены почти все чекбоксы + МА шаг 25)
- Обновлен UI
- Фикс WFA движка - для расчета окон не использовался Date Range, выбранный в левой части UI, вместо этого использовались все данные
- Убрано сохранение csv в static, теперь только загрузка через Download по завершении работы
- Снято ограничение на Optuna 100 initial random trials (теперь max = 50000)
- Добавлен Warmup period для всего проекта - везде теперь добавляется Warmup Period (он равен самому длинному периоду MA * 1.5), это происходит во всех местах, где обрезается датасет
- Output WFA CSV data fix
	- Исправлены OOS и FW подсчет прибыли (был установлен initial capital = $10000 вместо $100)
	- Добавлен Net Profit% в IS окнах
	- В === WINDOW DETAILS === вместо номера бара пишется дата
	- В начале CSV пишутся даты IS-OOS, и FW Reserve
	- В Appearance теперь пишется в каком именно по счету окне была найдена комбинация
- Добавлен экспорт сделок скрипта (только для WFA режима) - они скачиваются в отдельный ZIP после завершения работы, их можно загрузить в TV с помощью Trading Report Generator
- Все названия выходных файлов стандартизированы (в конце добавляется режим работы - Grid, Optuna, Optuna+WFA)
- Добавлена возможность при включенном WFA обрабатывать несколько тикеров
#### [0.1.6] - 2025-11-10
- Фикс некорректной цены выхода по трейлингу (если он выше для лонга и ниже для шорта) - была глобальная проблема в подсчете цены закрытия, исправлено в файлах backtest_engine.py и optimizer_engine.py
#### [0.1.5] - 2025-11-06
- Добавлена оптимизация через Optuna
- Исправлена проблема с Score 15.00 при Optuna optimization (некорректно считался)
- Исправлена проблема с Stop X = 1.7000000000000002 и для 2.4 также
- Сокращены названия столбцов в выходном CSV
- В выходном CSV переименована Optimization Metadata => Optuna Metadata
#### [0.0.17] - 2025-11-02
- Добавлена Score System из 6 параметров (в том числе Sharpe Ratio (исправленный), все записывается в выходной CSV) - это было предложение Клода
- Добавлен Lock для типов Trail MA
#### [0.0.15] - 2025-10-29
- Убраны T MA Type и TrailMA Type столбцы из выходного CSV (если они не перебирались), перенесены в блок параметров - одинаковая логика для всего блока и всех параметров
- Добавлены пресеты + импорт пресетов из выходного CSV (все, что прописано в блоке залоченных параметров), если параметр участвовал в переборе, то он не импортируется пресетом. Можно перезаписывать дефолтные настройки и добавленные пресеты (правая не участвует, ее пресеты не касаются)
#### [0.0.13] - 2025-10-28
- Более точный подсчет ETA - теперь учитывается количество свечей во входном CSV и даты тестирования
- Добавлен Net Profit Filter - удаление из выходного CSV строк с Net Profit% меньше заданного
- Исправлено длинное число в Trail RR Long/Short в выходном CSV
#### [0.0.10] - 2025-10-27
- Переименованы столбцы в выходном CSV:
Max Drawdown% => Max DD%
Total Trades => Trades
- В начале выходного CSV записан блок зафиксированных параметров, которые НЕ перебирались, также они исключены из таблицы (строка заменена на блок, так удобнее)
- Сделан подсчет ETA из расчета 6 воркеров = 16 комбинаций/сек (ETA меняется при изменении количества воркеров)
- Сделан выбор нескольких CSV на вход (с ctrl или мышкой в папке)
#### [0.0.6] - 2025-10-26
- По дефолту все галочки в правой части отключены
- Фикс Trail MA Length (ругался на значение 5)
- Добавлен выбор количества воркеров (дефолт 6)
- Название CSV на выходе исправлено (пример "OKX_COREUSDT.P, 30 2024.01.01-2025.10.01_ALL.csv")
- В начале выходного CSV записана строка зафиксированных параметров, которые НЕ перебирались, также они исключены из таблицы
- Добавлен прогресс бар в терминале
